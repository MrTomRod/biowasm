diff --git a/Makefile b/Makefile
index fce03eb8..05849e84 100644
--- a/Makefile
+++ b/Makefile
@@ -21,7 +21,7 @@ OBJ_DIR	= obj
 BIN_DIR	= bin
 SRC_DIR	= src
 
-CXX     = g++
+CXX     = em++
 
 PYTHON ?= $(shell python --version >/dev/null 2>&1 && echo "python" || echo python3)
 
@@ -30,7 +30,7 @@ BT_CPPFLAGS = -DDEBUG -D_DEBUG -D_FILE_OFFSET_BITS=64 -DWITH_HTS_CB_API $(INCLUD
 BT_CXXFLAGS = -Wconversion -Wall -Wextra -g -O0
 else
 BT_CPPFLAGS = -D_FILE_OFFSET_BITS=64 -DWITH_HTS_CB_API $(INCLUDES)
-BT_CXXFLAGS = -g -Wall -O2
+BT_CXXFLAGS = -w -O2
 endif
 
 # If the user has specified to do so, tell the compile to use rand() (instead of mt19937).
@@ -133,7 +133,7 @@ ALL_LDFLAGS  = $(BT_LDFLAGS) $(LDFLAGS)
 ALL_LIBS     = $(BT_LIBS) $(LIBS)
 
 
-all: print_banner $(BIN_DIR)/bedtools $(BIN_DIR)/intersectBed test/htsutil
+all: print_banner $(BIN_DIR)/bedtools
 
 static: print_banner $(BIN_DIR)/bedtools.static
 
@@ -179,7 +179,7 @@ $(BUILT_OBJECTS): | $(OBJ_DIR)
 
 $(BIN_DIR)/bedtools: autoversion $(BUILT_OBJECTS) $(HTSDIR)/libhts.a | $(BIN_DIR)
 	@echo "- Building main bedtools binary."
-	$(CCPREFIX) $(CC_WRAPPER) $(CXX) $(ALL_LDFLAGS) -o $(BIN_DIR)/bedtools $(BUILT_OBJECTS) $(HTSDIR)/libhts.a $(ALL_LIBS)
+	$(CCPREFIX) $(CC_WRAPPER) $(CXX) $(ALL_LDFLAGS) -o $(BIN_DIR)/bedtools.js $(BUILT_OBJECTS) $(HTSDIR)/libhts.a $(ALL_LIBS)
 	@echo "done."
 
 $(BIN_DIR)/bedtools.static: autoversion $(BUILT_OBJECTS) $(HTSDIR)/libhts.a | $(BIN_DIR)
diff --git a/src/utils/htslib/Makefile b/src/utils/htslib/Makefile
index 2931898e..e6ceb0ae 100644
--- a/src/utils/htslib/Makefile
+++ b/src/utils/htslib/Makefile
@@ -22,12 +22,12 @@
 # FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 # DEALINGS IN THE SOFTWARE.
 
-CC     = gcc
-AR     = ar
-RANLIB = ranlib
+CC     = emcc
+AR     = emar
+RANLIB = emranlib
 
 # Default libraries to link if configure is not used
-htslib_default_libs = -lz -lm -lbz2 -llzma
+htslib_default_libs = -s USE_ZLIB=1 -lm -s USE_BZIP2=1 -llzma
 
 CPPFLAGS =
 # TODO: probably update cram code to make it compile cleanly with -Wc++-compat
@@ -179,7 +179,6 @@ thread_pool_internal_h = thread_pool_internal.h $(htslib_thread_pool_h)
 config.h:
 	echo '/* Default config.h generated by Makefile */' > $@
 	echo '#define HAVE_LIBBZ2 1' >> $@
-	echo '#define HAVE_LIBLZMA 1' >> $@
 	echo '#ifndef __APPLE__' >> $@
 	echo '#define HAVE_LZMA_H 1' >> $@
 	echo '#endif' >> $@
